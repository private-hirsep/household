{% extends 'base.html' %}

{% block content %}
<h1>Task List</h1>

<p><a href="{% url 'task-add' %}" class="btn">Add Task</a></p>

<table>
  <thead>
    <tr>
      <th>Title</th>
      <th>Assignee</th>
      <th>Due Date</th>
      <th>Done</th>
    </tr>
  </thead>
  <tbody>
    {% for task in tasks %}
    <tr>
      <td><a href="{% url 'task-detail' task.pk %}">{{ task.title }}</a></td>
      <td>{{ task.get_assignee_display }}</td>
      <td>{{ task.due_date|default:"â€”" }}</td>
      <td>
        <form method="post" action="{% url 'task-toggle' task.pk %}" class="toggle-form">
          {% csrf_token %}
          <input type="checkbox" onChange="this.form.submit()" {% if task.completed %}checked{% endif %}>
        </form>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="4">There are no tasks yet.</td></tr>
    {% endfor %}
  </tbody>
</table>
<form method="post" action="{% url 'task-clear' %}" style="display:inline;">
  {% csrf_token %}
  <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete all checked items?');">
    Clear Tasks
  </button>
</form>
{% endblock %}
